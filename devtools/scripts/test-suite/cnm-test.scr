; CNM Test Suite - Main Test Script
; Purpose: Comprehensive regression testing for the entire CNM Plus repository, focusing at the moment on bubble notes auto text and updater.
;
; Execution: Drag this .scr file into cnm-test-start.dwg
;
; Config:
; Note that all spaces are significant on script lines. You can't pad anything.
; Deletes file at start.
; Turn on logging.
; This logs all debug messages to (strcat (getvar "dwgprefix") "haws-debug-log.md").
; Logging may have unacceptable overhead.
(haws-setvar "DebugLevel" "1")
; Clocking may have unacceptable overhead.
;(load "haws-clock.lsp")
;
; Prerequisites:
;   1. Open cnm-test-start.dwg with Civil 3D objects prepared.
;   2. Ensure CNM is loaded
;   3. Add test folder to AutoCAD's Trusted Locations:
;      OPTIONS → Files → Trusted Locations → Add → Select devtools/scripts/test-suite
;   4. Drawing must be on TEST-LAYOUT (not Model tab)
;   5. Script uses MSPACE/PSPACE for space switching (not LAYOUT command)
;
; Output:
;   - MTEXT annotations on C-ANNO-TEST-RESULTS layer
;   - cnm-test-report.md file for AI analysis
;   - Summary MTEXT at top of drawing
;
; Script Style Guidelines:
;   - All command options spelled out (not minimum mnemonics) for readability
;   - Example: "extents" not "e"
;   - Makes scripts self-documenting and easier to maintain
;
; CRITICAL FOR AI AGENTS - Script Line Break Handling:
;   Scripts differ from code - EVERY line and space (including blanks) is significant!
;
;
; BUBBLE NOTES AUTO TEXT TEST ORGANIZATION
;
; 1. Initial properties:
;    1.1. Alignment: Name "OAK ST", Start point (10040, 20240), End point (10680,20240)
;    1.2. Pipe: Start point (10040, 20200, 100), End point (10680,20200, 98), Length 640, SLOPE 0.3125%
;    1.3. Bubble notes insertion grid is defined at test-grid-coordinates.csv
;    1.4. Viewport translation: Scale 1/20XP, Alignment start PS coordinates 2,12
; 2. Elements to test: paper/model, left/right, all (16) auto text types (can do with 8 bubbles or enable more lines per bubble), copy, flip, stretch all coordinate-based arrowheads, stretch alignment and pipe, updater.
; 3. Bubbles to place:
;    ID  Col Row TYP NUM   Line1   Assertion               Line2 Assertion    COORD-P SPACE X1,Y1        X2,Y2       NOTES
;    1   1L  3U  BOX 2     NE      N 20270.00, E 10340.00  TEXT  [SEE NOTES]  T       PS    17.0,13.5    16.8,14.0   SELECT TEXT AT (14,12.5) STRING = "CLICK HERE (```), THEN NE, THEN OK."
;    1E  (post-edit)               N 20270.00, E 10340.00        [SEE NOTES]  T       PS                             Line2 = "CLICK HERE (N 20270.00, E 10340.00), THEN NE, THEN OK."
;    2   1L  2U  CIR 2     STAOFF  STA 53+00.00, 20.00 LT  ENTRY [SEE NOTES]  T       PS    17.0,13.0    16.8,13.5   Line2 = "CLICK HERE, THEN STAOFF, THEN OK."
;    2E  (post-edit)               STA 53+00.00, 20.00 LT        [SEE NOTES]  T       PS                             Line2 = "CLICK HERE, THEN STAOFF, THEN OK.STA 53+00.00, 20.00 LT"
;    3   1L  CEN DIA 2     STANAME STA 53+00.00 OAK ST     OFF   0.00' RT     T       PS    17.0,12.0    16.8,12.5
;    4   1L  4D  HEX 2     DIA     18"                     SLOPE 0.31%        NIL     PS    17.0,10.0    16.8,9.5
;    5   1R  3U  BOX 1     SF      3840 SF                 SY    427 SY       NIL     MS    10380,20270  10385,20280
;    6   1R  2U  CIR 1     LF      640 LF                  N     N 20260.00   T       MS    10380,20260  10385,20270
;    7   1R  CEN DIA 2     NAME    OAK ST                  STA   STA 53+40.00 T       MS    10380,20240  10385,20250
;    8   1R  4D  OCT 1     L       L=640'                  E     E 10380.00   T       MS    10380,20200  10385,20190
; 4. Notes:
;    4.1. Bubbles 1 and 2 are edited after placement and validation. Then their edits are validated (second validation). Tester simply clicks OK in the editor dialog.
;    4.2. The test suite has a custom cnm.ini to force expected behavior for validation. This allows testing on user machines.
;
;   HAWS-???L prompt sequence (bubble insertion):
;     Line N:   Command name (HAWS-???L)
;     Line N+1: Arrow point coordinate
;     Line N+2: Bubble note insertion point coordinate
;     Line N+3: Note number
;     Line N+4: Line 1 text response (blank = skip, "." = auto-text, "text" = manual)
;     Line N+5: [if "." on N+4] Auto-type selection. See cnm.lsp:hcnm-bn-auto-text-definitions function
;     Line N+6: [if auto-text needs it] Object selection coordinate
;     Line N+7: [if paper space] Viewport assignment (Enter accepts only viewport in test drawing)
;     Line N+8: Line 2 text response (blank = skip, "." = auto-text, "text" = manual)
;
;   VIEWPORT ASSIGNMENT (paper space only):
;     Every new paper space bubble note needs a viewport assignment so CNM knows
;     which viewport to "look through" for model space coordinate tranSForms.
;     - If the auto-text requires an object selection (Sta/Off/STAOFF/DIA/etc.),
;       the viewport is determined from the selected object's viewport. No extra prompt.
;     - If there is NO object to select (N/E/NE), CNM prompts the user to click
;       the target viewport. In the test drawing there is only one viewport,
;       so all we need is an extra blank line (Enter) to accept it.
;     - Model space bubbles never need viewport assignment.
;
;   Example - Box bubble note with handle-based coordinate-based auto-text on Line 1, skip Line 2 (model space):
;     HAWS-BOXL
;     850,600      ; Arrow point
;     800,600      ; Leader start
;     1            ; Note number
;     .            ; Line 1: use auto-text
;     sta          ; Auto-type selection
;     800,500      ; Alignment selection (also determines viewport if paper space)
;                  ; Line 2: blank = skip (CRITICAL - don't omit this!)
;
;   Example - Circle bubble note with handleless coordinate-based auto-text (paper space, viewport prompt):
;     HAWS-CIRL
;     17.0,13.0    ; Arrow point (paper space coords)
;     16.75,13.5   ; Leader start (paper space coords)
;     15           ; Note number
;     .            ; Line 1: use auto-text
;     n            ; Auto-type: Northing (no object to select)
;                  ; Viewport assignment: Enter accepts the one viewport
;                  ; Line 2: blank = skip
;
;   Common AI mistake: Forgetting Line 2 skip blank after auto-text selection
;   Without that blank, script fails or puts unexpected text on Line 2
;
; Debugging Tips:
;   - Run one test at a time by copying lines to AutoCAD command line
;   - Check (entlast) after each HAWS-ELLL to verify bubble created
;   - Use (test-validate-auto-text ...) manually to check expected values
;   - If script fails, check line number in error message
;   - Common failures: Missing objects, wrong coordinates, CVPORT issues
;
; === SETUP ===
; As of v5.5.37, cnm only autoloads, which is good progress (previously was front-loaded for its config functions used elsewhere). So we load it here for the config functions used here.
(load "cnm")
; Delete debug log from previous test runs
(if (findfile (strcat (getvar "dwgprefix") "haws-debug-log.md")) (vl-file-delete (strcat (getvar "dwgprefix") "haws-debug-log.md")))
(haws-tip 10 "Script conditions and notes.\n\n1. Changes and tries to restore the following variable settings. If it fails to complete, you may need to restore them the way you want them manually.\n\n\t- (setvar \"expert\" 2).\n\n2. Assumes that bubble prompts are enabled for only Line 1 and Line 2, and that Skip Entry Prompt is turned off.")
fileDIA
0
(setq *expert-old* (getvar "expert"))
(setvar "expert" 2)
(command "._saveas" "" (strcat (getvar "dwgprefix") "cnm-test.dwg"))
(setvar "expert" *expert-old*)
(load (strcat (getvar "dwgprefix") "cnm-test-validation.lsp"))
(c:test-setup-layers)
(test-write-report-header)
(c:test-log-start)
; Switch to model space for initial zoom (drawing starts on TEST-LAYOUT)
mspace
zoom
extents
;
; === BUBBLE NOTES AUTO TEXT TESTS ===
; 8 planned insertions testing all 16 auto-text types (2 per bubble)
; See plan at header lines 46-57
; See notes 4.1 (editor tests) and 4.2 (custom cnm.ini)
;
; PREREQUISITE: cnm-test-start.dwg must contain a TEXT entity at paper space
; coordinates (14,12.5) with string "CLICK HERE (```), THEN NE, THEN OK."
; for the Text auto-type test in Bubble 1 Line 2.
;
; === PAPER SPACE BUBBLES 1-4 ===
pspace
;;
;; BUBBLE 1: NE + Text (Paper Space, 1L 3U)
;; Arrow: 17.0,13.5 (PS) = Model (10340,20270)
;; Bubble: 16.8,14.0
;; Line 1: NE (handleless → viewport prompt, Enter accepts)
;; Line 2: Text (select text entity at PS 14,12.5)
;; COORD-P: T
;;
HAWS-BOXL
17.0,13.5
16.8,14.0
2
.
ne

.
text
14,12.5
(test-validate-auto-text (entlast) "NOTETXT1" "N 20270.00, E 10340.00" "BUBBLE 1, BOX 1, LINE 1: NE (Paper)")
(test-validate-xdata (entlast) "NOTETXT1" "NE" "BUBBLE 1, BOX 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "CLICK HERE (```), THEN NE, THEN OK." "BUBBLE 1, BOX 1, LINE 2: Text (Paper)")
(test-validate-vptrans-created (entlast) "BUBBLE 1, BOX 1")
;;
;; === EDITOR WORKFLOW TESTS (Note 4.1, plan entries 1E and 2E) ===
;; Bubbles 1 and 2 are edited after placement and validation.
;; CRITICAL: These tests require tester to click OK in the edit dialog.
;; Script pauses at editor dialog, resumes when tester clicks OK.
;; Post-edit: Verify values expected after roundtrip through editor.
;;
;; EDIT BUBBLE 1 (1E): Editor auto text insertion test
;; Tester sees edit dialog for Bubble 1. Action: Click in Line 2, then click NE, then click OK.
;; Expected: Line 1 unchanged. Line 2 per plan.
;;
pspace
;; Invoke editor: pick bubble 1, Enter to end selection
HAWS-EE
last

;; dialog opens. Tester clicks as instructed. Script resumes.
;; Post-edit validation (1E): verify values expected after roundtrip
(test-validate-auto-text (entlast) "NOTETXT1" "N 20270.00, E 10340.00" "EDIT 1E, BOX 1, LINE 1: NE preserved after edit")
(test-validate-xdata (entlast) "NOTETXT1" "NE" "EDIT 1E, BOX 1")
(test-validate-auto-text (entlast) "NOTETXT2" "CLICK HERE (N 20270.00, E 10340.00), THEN NE, THEN OK." "EDIT 1E, BOX 1, LINE 2: NE inserted at ``` after edit")
(test-validate-xdata (entlast) "NOTETXT2" "NE" "EDIT 1E, BOX 1, LINE 2")
;;
;; BUBBLE 2: STAOFF + Entry (Paper Space, 1L 2U)
;; Arrow: 17.0,13.0 (PS) = Model (10340,20260)
;; Bubble: 16.8,13.5
;; Line 1: STAOFF (alignment selection → determines viewport)
;; Line 2: Entry (default with no . entry)
;; COORD-P: T
;;
HAWS-CIRL
17.0,13.0
16.8,13.5
2
.
STAOFF
10360,20240
CLICK HERE, THEN STAOFF, THEN OK.
(test-validate-auto-text (entlast) "NOTETXT1" "STA 53+00.00, 20.00 LT" "BUBBLE 2, CIR 1, LINE 1: STAOFF (Paper)")
(test-validate-xdata (entlast) "NOTETXT1" "STAOFF" "BUBBLE 2, CIR 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "CLICK HERE, THEN STAOFF, THEN OK." "BUBBLE 2, CIR 1, LINE 2: Manual text entry")
(test-validate-vptrans-created (entlast) "BUBBLE 2, CIR 1")
;;
;; EDIT BUBBLE 2 (2E): Editor auto text appending test
;; Tester sees edit dialog for Bubble 2. Action: Just click OK.
;; Expected: Line 1 unchanged. Line 2 per plan.
;;
;; Invoke editor: pick bubble 2, Enter to end selection
HAWS-EE
last

;; dialog opens. Tester clicks as instructed. Accept previous alignment selection.

;; Tester clicks OK. Script resumes.
;; Post-edit validation (2E): verify values expected after roundtrip
(test-validate-auto-text (entlast) "NOTETXT1" "STA 53+00.00, 20.00 LT" "EDIT 2E, CIR 1, LINE 1: STAOFF preserved after edit")
(test-validate-xdata (entlast) "NOTETXT1" "STAOFF" "EDIT 2E, CIR 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "CLICK HERE, THEN STAOFF, THEN OK.STA 53+00.00, 20.00 LT" "EDIT 2E, CIR 1, LINE 2: STAOFF appended after edit")
(test-validate-xdata (entlast) "NOTETXT2" "STAOFF" "EDIT 2E, CIR 1, LINE 2")
;;
;;
;; BUBBLE 3: STANAME + OFF (Paper Space, 1L CEN)
;; Arrow: 17.0,12.0 (PS) = Model (10340,20240) - exactly on alignment
;; Bubble: 16.8,12.5
;; Line 1: STANAME (alignment selection → determines viewport)
;; Line 2: OFF (reuses alignment from Line 1 with Enter)
;; COORD-P: T
;;
HAWS-DIAL
17.0,12.0
16.8,12.5
2
.
STANAME
10360,20240
.
off

(test-validate-auto-text (entlast) "NOTETXT1" "STA 53+00.00 OAK ST" "BUBBLE 3, DIA 1, LINE 1: STANAME (Paper)")
(test-validate-xdata (entlast) "NOTETXT1" "STANAME" "BUBBLE 3, DIA 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "0.00 RT" "BUBBLE 3, DIA 1, LINE 2: OFF (Paper)")
(test-validate-xdata (entlast) "NOTETXT2" "OFF" "BUBBLE 3, DIA 1, LINE 2")
(test-validate-vptrans-created (entlast) "BUBBLE 3")
;; HCNM-REPLACE-BUBBLE TEST ON BUBBLE 3.
HCNM-REPLACE-BUBBLE
last
17.2,11.5
(test-validate-auto-text (entlast) "NOTETXT1" "STA 53+00.00 OAK ST" "REPLACE BUBBLE 3, DIA 1, LINE 1: STANAME (Paper)")
(test-validate-xdata (entlast) "NOTETXT1" "STANAME" "REPLACE BUBBLE 3, DIA 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "0.00 RT" "REPLACE BUBBLE 3, DIA 1, LINE 2: OFF (Paper)")
(test-validate-xdata (entlast) "NOTETXT2" "OFF" "REPLACE BUBBLE 3, DIA 1, LINE 2")
(test-validate-vptrans-created (entlast) "REPLACE BUBBLE 3")
;;
;; BUBBLE 4: DIA + SLOPE (Paper Space, 1L 4D)
;; Arrow: 17.0,10.0 (PS) = Model (10340,20200) - on pipe row
;; Bubble: 16.8,9.5
;; Line 1: DIA (pipe selection → determines viewport)
;; Line 2: SLOPE (pipe selection again - pipe has no reuse mechanism)
;; COORD-P: NIL
;;
HAWS-HEXL
17.0,10.0
16.8,9.5
2
.
DIA
10360,20200
.
SLOPE
10360,20200
(test-validate-auto-text (entlast) "NOTETXT1" "18\"" "BUBBLE 4, HEX 1, LINE 1: DIA (Paper)")
(test-validate-xdata (entlast) "NOTETXT1" "DIA" "BUBBLE 4, HEX 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "0.31%" "BUBBLE 4, HEX 1, LINE 2: SLOPE (Paper)")
(test-validate-xdata (entlast) "NOTETXT2" "SLOPE" "BUBBLE 4, HEX 1, LINE 2")
;;
;; === MODEL SPACE BUBBLES 5-8 ===
mspace
;;
;; BUBBLE 5: SF + SY (Model Space, 1R 3U)
;; Arrow: 10380,20270
;; Bubble: 10385,20280
;; Line 1: SF (field-based, sidewalk rectangle selection at 10360,20272)
;; Line 2: SY (field-based, same sidewalk rectangle)
;; COORD-P: NIL
;;
HAWS-BOXL
10380,20270
10385,20280
1
.
SF
10360,20272
.
SY
10360,20272
;; SF field validation: Check for field code with SF suffix
(if (and (setq test-text (cadr (assoc "NOTETXT1" (hcnm-bn-dwg-to-lattribs (entlast))))) (vl-string-search "%<\\AcObjProp" test-text) (vl-string-search "SF" test-text)) (test-validate-auto-text (entlast) "NOTETXT1" test-text "BUBBLE 5: SF (Model)") (test-validate-auto-text (entlast) "NOTETXT1" "FIELD ERROR" "BUBBLE 5, BOX 2, LINE 1: SF (Model)"))
(test-validate-xdata (entlast) "NOTETXT1" "SF" "BUBBLE 5, BOX 2, LINE 1")
;; SY field validation: Check for field code with SY suffix
(if (and (setq test-text (cadr (assoc "NOTETXT2" (hcnm-bn-dwg-to-lattribs (entlast))))) (vl-string-search "%<\\AcObjProp" test-text) (vl-string-search "SY" test-text)) (test-validate-auto-text (entlast) "NOTETXT2" test-text "BUBBLE 5: SY (Model)") (test-validate-auto-text (entlast) "NOTETXT2" "FIELD ERROR" "BUBBLE 5, BOX 2, LINE 2: SY (Model)"))
(test-validate-xdata (entlast) "NOTETXT2" "SY" "BUBBLE 5, BOX 2, LINE 2")
;;
;; BUBBLE 6: LF + N (Model Space, 1R 2U)
;; Arrow: 10380,20260
;; Bubble: 10385,20270
;; Line 1: LF (field-based, curb line selection at 10360,20260)
;; Line 2: N (handleless, no selection in MS, uses arrow Y = 20260)
;; COORD-P: T
;;
HAWS-CIRL
10380,20260
10385,20270
1
.
lf
10360,20260
.
n
;; LF field validation: Check for field code with LF suffix
(if (and (setq test-text (cadr (assoc "NOTETXT1" (hcnm-bn-dwg-to-lattribs (entlast))))) (vl-string-search "%<\\AcObjProp" test-text) (vl-string-search "LF" test-text)) (test-validate-auto-text (entlast) "NOTETXT1" test-text "BUBBLE 6: LF (Model)") (test-validate-auto-text (entlast) "NOTETXT1" "FIELD ERROR" "BUBBLE 6, CIR 2, LINE 1: LF (Model)"))
(test-validate-xdata (entlast) "NOTETXT1" "LF" "BUBBLE 6, CIR 2, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "N 20260.00" "BUBBLE 6, CIR 2, LINE 2: N (Model)")
(test-validate-xdata (entlast) "NOTETXT2" "N" "BUBBLE 6, CIR 2, LINE 2")
;;
;; BUBBLE 7: Name + Sta (Model Space, 1R CEN)
;; Arrow: 10380,20240 - on alignment
;; Bubble: 10385,20250
;; Line 1: Name/AlName (alignment selection at 10360,20240)
;; Line 2: Sta (reuses alignment from Line 1 with Enter)
;; COORD-P: T (Sta uses arrow X = 10380, station = 3+40.00)
;;
HAWS-DIAL
10380,20240
10385,20250
2
.
name
10360,20240
.
sta

(test-validate-auto-text (entlast) "NOTETXT1" "OAK ST" "BUBBLE 7, DIA 1, LINE 1: Name (Model)")
(test-validate-xdata (entlast) "NOTETXT1" "NAME" "BUBBLE 7, DIA 1, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "STA 53+40.00" "BUBBLE 7, DIA 1, LINE 2: Sta (Model)")
(test-validate-xdata (entlast) "NOTETXT2" "STA" "BUBBLE 7, DIA 1, LINE 2")
;;
;; BUBBLE 8: L + E (Model Space, 1R 4D)
;; Arrow: 10380,20200 - on pipe
;; Bubble: 10385,20190
;; Line 1: L (pipe selection at 10360,20200)
;; Line 2: E (handleless, no selection in MS, uses arrow X = 10380)
;; COORD-P: T
;;
HAWS-OCTL
10380,20200
10385,20190
1
.
L
10360,20200
.
e
(test-validate-auto-text (entlast) "NOTETXT1" "L=640.00'" "BUBBLE 8, OCT 2, LINE 1: L (Model)")
(test-validate-xdata (entlast) "NOTETXT1" "L" "BUBBLE 8, OCT 2, LINE 1")
(test-validate-auto-text (entlast) "NOTETXT2" "E 10380.00" "BUBBLE 8, OCT 2, LINE 2: E (Model)")
(test-validate-xdata (entlast) "NOTETXT2" "E" "BUBBLE 8, OCT 2, LINE 2")
;; Return to model space for downstream tests
;;
mspace
;; PHASE J: CNM-DEMO COVERAGE - CNM PLUS UTILITIES
;;==============================================================================
;; Source: CNM-Demo.scr (appended with displacement +9800,+20400)
;; NOTE: Model Space must be current for these tests
;; Utilities tested: haws-contvol, haws-ut, haws-mof, haws-lotnum, haws-newpro
;;
;; Return to model space (required for CNM-Demo tests)
;;
mspace
;;
;; Disable osnap for precise coordinate entry
;;
-osnap
off
;;
;; Create contour layer for haws-contvol test
;;
-LAYER
m
C-TOPO-CONT
C
M


;;
;; TEST 27: haws-contvol (Contour Volume Calculation)
;; Draw nested polylines for volume calculation
;;
PLINE
10100,20750
10180,20750
10180,20850
10100,20850
C
OFFSET
4
10100,20750
10104,20754
10104,20754
10108,20758
10108,20758
10112,20762

;;
;; Run contour volume utility
;;
haws-contvol
10108,20758
10104,20754
10100,20750

10115,20830
;;
;; TEST 28-35: Bubble placement (CNM-Demo pattern)
;; Standard bubble insertion tests from original CNM-Demo
;;
HAWS-BOXL
10525,20650
@25<60
1
26 LF
3
HAWS-CIRL
10575,20650
@25<60
1
22 LF
INSIDE PROPERTY
HAWS-HEXL
10625,20650
@25<60
2
STA 46+57.28
3' R
HAWS-RECL
10675,20650
@25<60
1
456 LF

HAWS-BOXL
10760,20650
@25<120
1
280 LF

HAWS-PENL
10810,20650
@25<120
1
502 LF

HAWS-OCTL
10860,20650
@25<120
2


HAWS-DIAL
10910,20650
@25<120
2
STA. 5+22
5' L
;;
;; GENERATE KEY NOTES TABLE
;; Command: hcnm-cnmkt (Key Notes Table)
;; Prompts for search scope and insertion point
;;
(command "._QSAVE")
hcnm-cnmkt
10220,20850

;;
;; VALIDATE KEY NOTES TABLE
;; Check that Key Notes Table was generated
;; Check that .not file was created
;;
(c:test-validate-key-table)
;;==============================================================================
;; PHASE I: QUANTITY TAKEOFF TABLE TESTS
;;==============================================================================
;;
;; Create cnm-test.lst (sheet list for QT command)
;; Single-sheet test: cnm-test.dwg -> cnm-test.not
;;
(c:test-create-qt-lst-file)
;;
;; GENERATE QT TABLE
;; Command: hcnm-cnmqt (Quantity Takeoff Table)
;; Prompts for insertion point
;;
hcnm-cnmqt
Yes
Used
10750,20400
;;
;; VALIDATE QT TABLE
;;
(c:test-validate-qt-table)
;;
;; Create test layer for utilities
;;
-layer
make
C-ANNO-HCNM-TEST

;;
;; TEST 36-37: haws-ut (Utility function)
;; First test: Setup with specific parameters
;;
haws-ut
;Setup
e
w
24
28
CSCP

10560,20750
10860,20750
Arc
10900,20790

;;
;; Second test: Setup with different parameters
;;
haws-ut
Setup
p
w
28
10560,20760
10860,20760
Arc
10890,20790

;;
;; TEST 38: haws-mof (Multiple Offset)
;; Select base object and create multiple offsets
;;
haws-mof

10465,20573
10439,20595
10470,20595
10462,20638
10485,20632

;;
;; Create property identification layer
;;
-layer
make
C-PROP-IDEN

;;
;; TEST 39: haws-lotnum (Lot Numbering)
;; Number multiple lot boundaries
;;
haws-lotnum
1
mid
10957,20502
mid
10906,20502
mid
10855,20507
mid
10805,20507
mid
10755,20507
mid
10705,20507
mid
10655,20507
mid
10605,20507
mid
10555,20507
mid
10500,20504

;;
;; TEST 40: haws-newpro (New Profile)
;; Initialize Profile Drafter SYstem
;;
haws-newpro
;;
;; Set layer for final message
;;
-layer
set
C-ANNO-HCNM-TEST

; === SUMMARY ===
test-write-report-summary
;; Cleanup: remove project files for next test run
test-cleanup-project-files
test-log-end
; === SUCCESS MESSAGE ===
; Place in model space at top of drawing for visibility @ 1/20XP scale
; Generate truthful summary from actual test results
; Set TEXTEVAL=1 to evaluate AutoLISP expression in MTEXT
texteval
1
mtext
10360,20430
height
8
justify
TC
Width
0
(c:test-generate-summary-mtext)

texteval
0
fileDIA
1
sdi
0
; This is the end of the script. Do not add characters after this comment.